{"version":3,"file":"index.umd.production.min.cjs","sources":["../src/index.ts"],"sourcesContent":["import { runes } from 'runes2';\nimport { classPrototype } from \"es6-class-prototype\";\n\nexport interface IObjectWithSymbolSplit\n{\n\t[Symbol.split](separator?: RegExp | string, limit?: number): string[]\n}\n\nexport type IStringSplitInput = RegExp | string | IObjectWithSymbolSplit;\n\nexport const STRING_PROTOTYPE = Object.getOwnPropertyNames(String.prototype);\n\nexport class UString extends String\n{\n\tprotected _arr: string[] = null;\n\n\tconstructor(str: unknown, ...argv: unknown[])\n\t{\n\t\tsuper(str);\n\n\t\tlet d = Object.getOwnPropertyDescriptor(this, '_arr');\n\t\tObject.defineProperty(this, '_arr', Object.assign(d, {\n\t\t\tconfigurable: true,\n\t\t\tenumerable: false,\n\t\t}));\n\t}\n\n\toverride [Symbol.iterator]()\n\t{\n\t\treturn UString.toArray(this)[Symbol.iterator]();\n\t}\n\n\tstatic isString(str: unknown): str is string | String\n\t{\n\t\treturn (typeof str === 'string' || str instanceof String);\n\t}\n\n\tstatic toArray(str: unknown)\n\t{\n\t\tif (str instanceof UString)\n\t\t{\n\t\t\treturn str.toArray();\n\t\t}\n\n\t\treturn runes(String(str));\n\t}\n\n\ttoArray(): string[]\n\t{\n\t\tif (!this._arr)\n\t\t{\n\t\t\tthis._arr = runes(String(this));\n\t\t}\n\n\t\treturn this._arr;\n\t}\n\n\toverride split(separator?: IStringSplitInput, limit?: number): string[]\n\t{\n\t\tlet ret: string[];\n\t\tlet str = String(this);\n\n\t\tif (separator === '')\n\t\t{\n\t\t\tret = UString.toArray(this);\n\n\t\t\tif (typeof limit !== 'undefined')\n\t\t\t{\n\t\t\t\tret = ret.slice(0, limit);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tret = String.prototype.split.call(str, separator as any, limit)\n\t\t}\n\n\t\treturn ret;\n\t}\n\n\toverride substr(start: number, length?: number): string\n\t{\n\t\treturn UString.toArray(this).slice(start).slice(0, length).join('');\n\t}\n\n\toverride substring(start: number, indexEnd?: number)\n\t{\n\t\tif (Number.isNaN(start) || start < 0)\n\t\t{\n\t\t\tstart = 0;\n\t\t}\n\n\t\tif (typeof indexEnd === 'number')\n\t\t{\n\t\t\tif (Number.isNaN(indexEnd) || indexEnd < 0)\n\t\t\t{\n\t\t\t\tindexEnd = 0;\n\t\t\t}\n\n\t\t\tif (start > indexEnd)\n\t\t\t{\n\t\t\t\t[start, indexEnd] = [indexEnd, start];\n\t\t\t}\n\t\t}\n\n\t\treturn this.slice(start, indexEnd);\n\t}\n\n\toverride indexOf(search: string, start: number = 0): number\n\t{\n\t\tlet a = UString.toArray(this);\n\n\t\tstart = Math.max(0, Math.min(a.length, start));\n\t\tsearch = String(search);\n\n\t\tif (search === '')\n\t\t{\n\t\t\treturn start;\n\t\t}\n\n\t\ta = a.slice(start);\n\n\t\tlet s = UString.toArray(search);\n\n\t\tlet i = 0;\n\t\tlet j = 0;\n\n\t\tlet se = s[s.length - 1];\n\n\t\tdo\n\t\t{\n\t\t\ti = a.indexOf(s[0], j);\n\n\t\t\tif (i !== -1)\n\t\t\t{\n\t\t\t\tif (a.slice(i, i + s.length).join('') === search)\n\t\t\t\t{\n\t\t\t\t\treturn start + i;\n\t\t\t\t}\n\n\t\t\t\tj = i;\n\n\t\t\t\tif (s.length > 1)\n\t\t\t\t{\n\t\t\t\t\ti = a.indexOf(se, i + 1);\n\t\t\t\t\tj = i - s.length;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tj++;\n\t\t}\n\t\twhile (i !== -1 && j < a.length);\n\n\t\treturn -1;\n\t}\n\n\toverride includes(search: string, start: number = 0)\n\t{\n\t\treturn UString.toArray(this).slice(start).join('').indexOf(search) !== -1\n\t}\n\n\toverride slice(start: number, indexEnd?: number)\n\t{\n\t\treturn UString.toArray(this).slice(start, indexEnd).join('');\n\t}\n\n\toverride charAt(index: number): string\n\t{\n\t\treturn this.substr(index, 1);\n\t}\n\n\toverride startsWith(search: string, pos?: number): boolean\n\t{\n\t\treturn this.substr(!pos || pos < 0 ? 0 : +pos, search.length)\n\t\t\t.indexOf(search) === 0\n\t\t\t;\n\t}\n\n\toverride endsWith(search: string, length?: number): boolean\n\t{\n\t\tlet a = UString.toArray(this);\n\t\tlet s = UString.toArray(search);\n\n\t\tif (typeof length === 'undefined' || length > a.length)\n\t\t{\n\t\t\tlength = a.length;\n\t\t}\n\n\t\treturn this.substring(length - s.length, length) === search;\n\t}\n\n\toverride padEnd(targetLength: number, padString: string)\n\t{\n\t\ttargetLength = targetLength >> 0; //floor if number or convert non-number to 0;\n\t\tpadString = String((typeof padString !== 'undefined' ? padString : ' '));\n\n\t\tlet str = this.split('');\n\t\tlet pad = this.split.call(padString, '');\n\n\t\tif (str.length > targetLength)\n\t\t{\n\t\t\treturn String(this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttargetLength = targetLength - str.length;\n\t\t\tif (targetLength > pad.length)\n\t\t\t{\n\t\t\t\tpadString += padString.repeat(targetLength / pad.length); //append to original to ensure we are longer than needed\n\n\t\t\t\t// @ts-ignore\n\t\t\t\tpad = new UString(padString);\n\t\t\t}\n\t\t\treturn String(this) + pad.slice(0, targetLength);\n\t\t}\n\t}\n\n\toverride padStart(targetLength: number, padString: string)\n\t{\n\t\ttargetLength = targetLength >> 0; //truncate if number or convert non-number to 0;\n\t\tpadString = String((typeof padString !== 'undefined' ? padString : ' '));\n\n\t\tlet str = this.split('');\n\t\tlet pad = this.split.call(padString, '');\n\n\t\tif (str.length > targetLength)\n\t\t{\n\t\t\treturn String(this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttargetLength = targetLength - str.length;\n\t\t\tif (targetLength > pad.length)\n\t\t\t{\n\t\t\t\tpadString += padString.repeat(targetLength / pad.length); //append to original to ensure we are longer than needed\n\n\t\t\t\t// @ts-ignore\n\t\t\t\tpad = new UString(padString);\n\t\t\t}\n\n\t\t\treturn pad.slice(0, targetLength) + String(this);\n\t\t}\n\t}\n\n\n\n\t/**\n\t * 𠮷 134071 20bb7\n\t */\n\toverride codePointAt(pos: number): number\n\t{\n\t\treturn this.toArray()[pos].codePointAt(0)\n\t}\n\n\tstatic UString = UString;\n\t/**\n\t * @private\n\t */\n\tstatic default = UString;\n\n\tstatic create(str: unknown, ...argv: unknown[])\n\t{\n\t\treturn new this(str, ...argv);\n\t}\n\n\t/**\n\t * 顯示 目前支援 unicode 的 method\n\t */\n\tstatic get support(): {\n\n\t\tsplit?: boolean,\n\t\tsubstr?: boolean,\n\t\tsubstring?: boolean,\n\t\tindexOf?: boolean,\n\t\tincludes?: boolean,\n\t\tslice?: boolean,\n\t\tcharAt?: boolean,\n\t\tstartsWith?: boolean,\n\t\tendsWith?: boolean,\n\t\tpadEnd?: boolean,\n\t\tpadStart?: boolean,\n\n\t\tcodePointAt?: boolean,\n\n\t\t[key: string]: boolean,\n\t}\n\t{\n\t\tlet prototype = classPrototype(this);\n\n\t\treturn Object.keys(prototype).reduce(function (a, b)\n\t\t{\n\t\t\tif (STRING_PROTOTYPE.includes(b))\n\t\t\t{\n\t\t\t\t// @ts-ignore\n\t\t\t\ta[b] = true;\n\t\t\t}\n\n\t\t\treturn a;\n\t\t}, {} as Record<keyof String, true | undefined>)\n\t}\n\n\tstatic indexOf(str: unknown, search: string, start: number = 0)\n\t{\n\t\treturn this.create(str).indexOf(search, start);\n\t}\n\n\tstatic includes(str: unknown, search: string, start: number = 0)\n\t{\n\t\treturn this.create(str).includes(search, start);\n\t}\n\n\t/**\n\t * splits a String object into an array of strings by separating the string into substrings, using a specified separator string to determine where to make each split.\n\t */\n\tstatic split(str: unknown, separator?: any, limit?: number)\n\t{\n\t\treturn this.create(str).split(separator, limit);\n\t}\n\n\tstatic substr(str: unknown, start: number, length?: number)\n\t{\n\t\treturn this.create(str).substr(start, length);\n\t}\n\n\tstatic substring(str: unknown, start: number, indexEnd?: number)\n\t{\n\t\treturn this.create(str).substring(start, indexEnd);\n\t}\n\n\tstatic slice(str: unknown, start: number, indexEnd?: number)\n\t{\n\t\treturn this.create(str).slice(start, indexEnd);\n\t}\n\n\tstatic charAt(str: unknown, index: number)\n\t{\n\t\treturn this.create(str).charAt(index);\n\t}\n\n\tstatic padEnd(str: unknown, targetLength: number, padString: string)\n\t{\n\t\treturn this.create(str).padEnd(targetLength, padString);\n\t}\n\n\tstatic padStart(str: unknown, targetLength: number, padString: string)\n\t{\n\t\treturn this.create(str).padStart(targetLength, padString);\n\t}\n\n\tstatic startsWith(str: unknown, search: string, pos?: number)\n\t{\n\t\treturn this.create(str).startsWith(search, pos);\n\t}\n\n\tstatic endsWith(str: unknown, search: string, length?: number)\n\t{\n\t\treturn this.create(str).endsWith(search, length);\n\t}\n\n\tget charLength()\n\t{\n\t\treturn UString.toArray(this).length;\n\t}\n\n\tsize()\n\t{\n\t\treturn UString.toArray(this).length;\n\t}\n\n\tstatic size(str: unknown)\n\t{\n\t\treturn this.create(str).size();\n\t}\n\n\t/**\n\t * 𠮷 134071 20bb7\n\t */\n\tstatic codePointAt(str: unknown, pos: number): number\n\t{\n\t\treturn this.create(str).codePointAt(pos)\n\t}\n\n}\n\nexport default UString;\n\n// @ts-ignore\nif (process.env.TSDX_FORMAT !== 'esm')\n{\n\tObject.defineProperty(UString, 'UString', { value: UString });\n\tObject.defineProperty(UString, 'default', { value: UString });\n\tObject.defineProperty(UString, \"__esModule\", { value: true });\n}\n"],"names":["STRING_PROTOTYPE","Object","getOwnPropertyNames","String","prototype","UString","_arr","constructor","str","argv","super","d","getOwnPropertyDescriptor","this","defineProperty","assign","configurable","enumerable","Symbol","iterator","toArray","static","runes","split","separator","limit","ret","slice","call","substr","start","length","join","substring","indexEnd","Number","isNaN","indexOf","search","a","Math","max","min","s","i","j","se","includes","charAt","index","startsWith","pos","endsWith","padEnd","targetLength","padString","pad","repeat","padStart","codePointAt","support","classPrototype","keys","reduce","b","create","charLength","size","value"],"mappings":"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"}